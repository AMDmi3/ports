Index: ftp/curl/Makefile
===================================================================
--- ftp/curl/Makefile	(revision 384340)
+++ ftp/curl/Makefile	(working copy)
@@ -12,12 +12,12 @@
 
 LICENSE=	MIT
 
-OPTIONS_DEFINE=	CA_BUNDLE COOKIES CURL_DEBUG DEBUG DOCS EXAMPLES HTTP2 IDN IPV6 LDAP LDAPS LIBSSH2 PROXY RTMP TLS_SRP
+OPTIONS_DEFINE=	CA_BUNDLE COOKIES CURL_DEBUG DEBUG DOCS EXAMPLES HTTP2 IDN IPV6 LDAP LDAPS LIBSSH2 PROXY RTMP TLS_SRP GSSAPI
 OPTIONS_RADIO=	RESOLV SSL
-OPTIONS_SINGLE=	GSSAPI
+OPTIONS_RADIO=	GSSAPIIMPL
 OPTIONS_RADIO_RESOLV=	CARES THREADED_RESOLVER
 OPTIONS_RADIO_SSL=	GNUTLS NSS OPENSSL POLARSSL
-OPTIONS_SINGLE_GSSAPI=	GSSAPI_BASE GSSAPI_HEIMDAL GSSAPI_MIT GSSAPI_NONE
+OPTIONS_RADIO_GSSAPIIMPL=	GSSAPI_BASE GSSAPI_HEIMDAL GSSAPI_MIT
 OPTIONS_DEFAULT=CA_BUNDLE COOKIES GSSAPI_BASE IPV6 OPENSSL PROXY RESOLV THREADED_RESOLVER SSL TLS_SRP
 CA_BUNDLE_DESC=	Install CA bundle for OpenSSL
 COOKIES_DESC=	Cookies support
@@ -25,7 +25,7 @@
 GSSAPI_BASE_DESC=	GSSAPI support via base system
 GSSAPI_HEIMDAL_DESC=	GSSAPI support via security/heimdal
 GSSAPI_MIT_DESC=	GSSAPI support via security/krb5
-GSSAPI_NONE_DESC=	Disable GSSAPI support
+GSSAPIIMPL_DESC=	GSS-API implementation (depends on GSSAPI knob)
 LIBSSH2_DESC=	SCP/SFTP support via libssh2
 RESOLV_DESC=	DNS resolving options
 THREADED_RESOLVER_DESC=	Threaded DNS resolver
@@ -77,22 +77,6 @@
 GNUTLS_CONFIGURE_OFF=	--without-gnutls
 GNUTLS_CONFIGURE_ON=	--with-gnutls=${LOCALBASE}
 GNUTLS_LIB_DEPENDS=	libgnutls.so:${PORTSDIR}/security/gnutls
-GSSAPI_BASE_CONFIGURE_ON=	--with-gssapi=${GSSAPIBASEDIR} ${GSSAPI_CONFIGURE_ARGS}
-GSSAPI_BASE_CPPFLAGS=	${GSSAPICPPFLAGS}
-GSSAPI_BASE_LDFLAGS=	${GSSAPILDFLAGS}
-GSSAPI_BASE_LIBS=	${GSSAPILIBS}
-GSSAPI_BASE_USES=	gssapi
-GSSAPI_HEIMDAL_CONFIGURE_ON=	--with-gssapi=${GSSAPIBASEDIR} ${GSSAPI_CONFIGURE_ARGS}
-GSSAPI_HEIMDAL_CPPFLAGS=${GSSAPICPPFLAGS}
-GSSAPI_HEIMDAL_LDFLAGS=	${GSSAPILDFLAGS}
-GSSAPI_HEIMDAL_LIBS=	${GSSAPILIBS}
-GSSAPI_HEIMDAL_USES=	gssapi:heimdal
-GSSAPI_MIT_CONFIGURE_ON=	--with-gssapi=${GSSAPIBASEDIR} ${GSSAPI_CONFIGURE_ARGS}
-GSSAPI_MIT_CPPFLAGS=	${GSSAPICPPFLAGS}
-GSSAPI_MIT_LDFLAGS=	${GSSAPILDFLAGS}
-GSSAPI_MIT_LIBS=	${GSSAPILIBS}
-GSSAPI_MIT_USES=	gssapi:mit
-GSSAPI_NONE_CONFIGURE_ON=	--without-gssapi
 HTTP2_BUILD_DEPENDS=	nghttp2>=0.6.0:${PORTSDIR}/www/nghttp2
 HTTP2_CONFIGURE_OFF=	--without-nghttp2
 HTTP2_CONFIGURE_ON=	--with-nghttp2=${LOCALBASE}
@@ -140,13 +124,35 @@
 .include <bsd.port.options.mk>
 
 .if ${PORT_OPTIONS:MCA_BUNDLE} && !${PORT_OPTIONS:MOPENSSL}
-IGNORE=		only supports CA bundle with OpenSSL
+IGNORE=         only supports CA bundle with OpenSSL
 .endif
 
 .if !${PORT_OPTIONS:MGNUTLS} && !${PORT_OPTIONS:MOPENSSL} && ${PORT_OPTIONS:MTLS_SRP}
-IGNORE=		only supports TLS-SRP with either OpenSSL or GnuTLS
+IGNORE=         only supports TLS-SRP with either OpenSSL or GnuTLS
 .endif
 
+.if ${PORT_OPTIONS:MGSSAPI}
+CONFIGURE_ARGS+=	--with-gssapi=${GSSAPIBASEDIR} ${GSSAPI_CONFIGURE_ARGS}
+CPPFLAGS+=	${GSSAPICPPFLAGS}
+LDFLAGS+=	${GSSAPILDFLAGS}
+LIBS+=	${GSSAPILIBS}
+.if ${PORT_OPTIONS:MGSSAPI_BASE}
+USES+=	gssapi
+.endif
+.if ${PORT_OPTIONS:MGSSAPI_HEIMDAL}
+USES+=	gssapi:heimdal
+.endif
+.if ${PORT_OPTIONS:MGSSAPI_MIT}
+USES+=	gssapi:mit
+.endif
+.else
+CONFIGURE_ARGS+=	--without-gssapi
+.endif
+
+.if ${PORT_OPTIONS:MGSSAPI} && ${PORT_OPTIONS:MGSSAPI_BASE} && ${PORT_OPTIONS:MOPENSSL} && defined(WITH_OPENSSL_PORT)
+IGNORE=		GSSAPI in base depends on base OpenSSL leading to conflicts with OpenSSL/LibreSSL from ports
+.endif
+
 .if !${PORT_OPTIONS:MLDAP} && ${PORT_OPTIONS:MLDAPS}
 IGNORE=		only supports LDAPS with LDAP
 .endif
@@ -159,14 +165,9 @@
 IGNORE=		only supports LIBSSH2 with OpenSSL
 .endif
 
-.if ${PORT_OPTIONS:MOPENSSL} && defined(OPENSSL_PORT) && ${OPENSSL_PORT} == "security/libressl"
-.if ${PORT_OPTIONS:MGSSAPI_BASE}
-IGNORE=		with GSSAPI_BASE, configure failed to detect OpenSSL/LibreSSL from ports and link against base OpenSSL
+.if ${PORT_OPTIONS:MTLS_SRP} && ${OPENSSL_PORT} == "security/libressl"
+IGNORE=		LibreSSL removed TLS-SRP
 .endif
-.if ${PORT_OPTIONS:MTLS_SRP}
-IGNORE=		unsupported TLS-SRP in LibreSSL
-.endif
-.endif
 
 post-patch:
 	@${REINPLACE_CMD} -e '/^SUBDIRS = / s|$$| docs|; /^DIST_SUBDIRS = / s| docs||; /cd docs &&/d' ${WRKSRC}/Makefile.in
